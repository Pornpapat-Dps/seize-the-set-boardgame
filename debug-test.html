<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö Set Operations Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ccc; margin: 10px 0; padding: 15px; }
        .pass { background-color: #d4edda; border-color: #c3e6cb; }
        .fail { background-color: #f8d7da; border-color: #f5c6cb; }
        .board { display: grid; grid-template-columns: repeat(8, 30px); gap: 1px; margin: 10px 0; }
        .cell { width: 30px; height: 30px; border: 1px solid #ccc; display: flex; align-items: center; justify-content: center; font-size: 10px; }
        .black { background-color: #333; color: white; }
        .white { background-color: #ddd; color: black; }
        .highlighted { background-color: yellow; }
        pre { background-color: #f8f9fa; padding: 10px; font-size: 12px; overflow-x: auto; }
        button { margin: 5px; padding: 8px 12px; }
    </style>
</head>
<body>
    <h1>üîß ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Set Operations Debug</h1>
    
    <div class="test-section">
        <h2>Test 1: Intersection + ‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á</h2>
        <button onclick="testIntersectionEmpty()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
        <div id="intersectionResult"></div>
        <div id="intersectionBoard" class="board"></div>
        <pre id="intersectionLog"></pre>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Complement + ‡πÄ‡∏ã‡∏ï 2x2</h2>
        <button onclick="testComplement2x2()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
        <div id="complement2x2Result"></div>
        <div id="complement2x2Board" class="board"></div>
        <pre id="complement2x2Log"></pre>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Complement + ‡πÄ‡∏ã‡∏ï 4x4</h2>
        <button onclick="testComplement4x4()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
        <div id="complement4x4Result"></div>
        <div id="complement4x4Board" class="board"></div>
        <pre id="complement4x4Log"></pre>
    </div>

    <script>
        function clearLogs() {
            document.querySelectorAll('pre').forEach(pre => pre.textContent = '');
        }
        
        function log(containerId, message) {
            const container = document.getElementById(containerId);
            container.textContent += message + '\n';
            console.log(message);
        }
        
        function displayBoard(board, containerId, highlightCells = []) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const pos = `${String.fromCharCode(65 + row)}${col + 1}`;
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.textContent = pos;
                    cell.style.fontSize = '8px';
                    
                    if (board[pos] === 'black') {
                        cell.classList.add('black');
                        cell.textContent = '‚ö´';
                    } else if (board[pos] === 'white') {
                        cell.classList.add('white');
                        cell.textContent = '‚ö™';
                    }
                    
                    if (highlightCells.includes(pos)) {
                        cell.classList.add('highlighted');
                    }
                    
                    container.appendChild(cell);
                }
            }
        }
        
        function setResult(containerId, message, isPass) {
            const container = document.getElementById(containerId);
            container.innerHTML = `<h3 style="color: ${isPass ? 'green' : 'red'}">${isPass ? '‚úÖ' : '‚ùå'} ${message}</h3>`;
        }

        function testIntersectionEmpty() {
            log('intersectionLog', '=== ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Intersection + ‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á ===');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            const gameBoard = {
                'A1': 'black', 'A2': 'white', 'A3': 'black',
                'B1': 'white', 'B2': 'black', 'B3': 'white',
                'C1': 'black', 'C2': 'white', 'C3': 'black',
                'D1': 'white', 'D2': 'black'
            };
            
            const currentPlayer = 'black';
            const opponentColor = 'white';
            
            log('intersectionLog', `‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏°‡∏µ ${Object.keys(gameBoard).length} ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢`);
            
            // ‡∏ô‡∏±‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
            const opponentTokensBefore = Object.keys(gameBoard).filter(pos => gameBoard[pos] === opponentColor);
            const blackTokensBefore = Object.keys(gameBoard).filter(pos => gameBoard[pos] === 'black');
            
            log('intersectionLog', `‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏î‡∏≥‡∏Å‡πà‡∏≠‡∏ô: ${blackTokensBefore.length} ‡∏ä‡πà‡∏≠‡∏á - ${blackTokensBefore.join(', ')}`);
            log('intersectionLog', `‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ç‡∏≤‡∏ß‡∏Å‡πà‡∏≠‡∏ô: ${opponentTokensBefore.length} ‡∏ä‡πà‡∏≠‡∏á - ${opponentTokensBefore.join(', ')}`);
            
            // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Intersection ‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á
            const setCard = { cells: [] }; // ‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á
            
            if (!setCard.cells || setCard.cells.length === 0) {
                log('intersectionLog', '‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°');
                
                // ‡∏´‡∏≤‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                const opponentTokens = [];
                for (let row = 0; row < 8; row++) {
                    for (let col = 0; col < 8; col++) {
                        const pos = `${String.fromCharCode(65 + row)}${col + 1}`;
                        if (gameBoard[pos] === opponentColor) {
                            opponentTokens.push(pos);
                        }
                    }
                }
                
                log('intersectionLog', `‡∏û‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°: ${opponentTokens.length} ‡∏ä‡πà‡∏≠‡∏á`);
                
                // ‡∏•‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°
                opponentTokens.forEach(pos => {
                    delete gameBoard[pos];
                });
                
                log('intersectionLog', `‡∏•‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à: ${opponentTokens.length} ‡∏ä‡πà‡∏≠‡∏á`);
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            const remainingTokens = Object.keys(gameBoard).filter(pos => gameBoard[pos]);
            const allBlack = remainingTokens.every(pos => gameBoard[pos] === 'black');
            const whiteRemaining = remainingTokens.filter(pos => gameBoard[pos] === 'white').length;
            
            log('intersectionLog', `‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö: ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ${remainingTokens.length} ‡∏ä‡πà‡∏≠‡∏á`);
            log('intersectionLog', `‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ç‡∏≤‡∏ß‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${whiteRemaining} ‡∏ä‡πà‡∏≠‡∏á`);
            log('intersectionLog', `‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≥: ${allBlack}`);
            
            const success = allBlack && whiteRemaining === 0 && opponentTokensBefore.length > 0;
            setResult('intersectionResult', 
                `Intersection + ‡πÄ‡∏ã‡∏ï‡∏ß‡πà‡∏≤‡∏á: ${success ? '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}`, 
                success
            );
            
            displayBoard(gameBoard, 'intersectionBoard');
        }

        function testComplement2x2() {
            log('complement2x2Log', '=== ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Complement + ‡πÄ‡∏ã‡∏ï 2x2 ===');
            
            const setCard = { cells: ['A1', 'A2', 'B1', 'B2'] }; // ‡πÄ‡∏ã‡∏ï 2x2
            
            log('complement2x2Log', `‡πÄ‡∏ã‡∏ï 2x2: ${setCard.cells.join(', ')}`);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ö‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô
            const allCells = [];
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    allCells.push(`${String.fromCharCode(65 + row)}${col + 1}`);
                }
            }
            
            log('complement2x2Log', `‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${allCells.length} ‡∏ä‡πà‡∏≠‡∏á`);
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Complement
            const resultCells = allCells.filter(pos => !setCard.cells.includes(pos));
            
            log('complement2x2Log', `Complement: ${resultCells.length} ‡∏ä‡πà‡∏≠‡∏á`);
            log('complement2x2Log', `‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á: ${64 - 4} = 60 ‡∏ä‡πà‡∏≠‡∏á`);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏ã‡∏ï‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô result
            const setInResult = setCard.cells.filter(pos => resultCells.includes(pos));
            log('complement2x2Log', `‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ã‡∏ï‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô result (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô 0): ${setInResult.length}`);
            
            const success = resultCells.length === 60 && setInResult.length === 0;
            setResult('complement2x2Result', 
                `Complement + ‡πÄ‡∏ã‡∏ï 2x2: ${success ? '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'} (${resultCells.length}/60 ‡∏ä‡πà‡∏≠‡∏á)`, 
                success
            );
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            const boardDisplay = {};
            resultCells.forEach(pos => boardDisplay[pos] = 'black');
            displayBoard(boardDisplay, 'complement2x2Board', setCard.cells);
        }

        function testComplement4x4() {
            log('complement4x4Log', '=== ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Complement + ‡πÄ‡∏ã‡∏ï 4x4 ===');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏ï 4x4 (A1-D4)
            const setCard = { cells: [] };
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 4; col++) {
                    setCard.cells.push(`${String.fromCharCode(65 + row)}${col + 1}`);
                }
            }
            
            log('complement4x4Log', `‡πÄ‡∏ã‡∏ï 4x4: ${setCard.cells.length} ‡∏ä‡πà‡∏≠‡∏á (A1-D4)`);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ö‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô
            const allCells = [];
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    allCells.push(`${String.fromCharCode(65 + row)}${col + 1}`);
                }
            }
            
            log('complement4x4Log', `‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${allCells.length} ‡∏ä‡πà‡∏≠‡∏á`);
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Complement
            const resultCells = allCells.filter(pos => !setCard.cells.includes(pos));
            
            log('complement4x4Log', `Complement: ${resultCells.length} ‡∏ä‡πà‡∏≠‡∏á`);
            log('complement4x4Log', `‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á: ${64 - 16} = 48 ‡∏ä‡πà‡∏≠‡∏á`);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏ã‡∏ï‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô result
            const setInResult = setCard.cells.filter(pos => resultCells.includes(pos));
            log('complement4x4Log', `‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ã‡∏ï‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô result (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô 0): ${setInResult.length}`);
            
            const success = resultCells.length === 48 && setInResult.length === 0;
            setResult('complement4x4Result', 
                `Complement + ‡πÄ‡∏ã‡∏ï 4x4: ${success ? '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'} (${resultCells.length}/48 ‡∏ä‡πà‡∏≠‡∏á)`, 
                success
            );
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            const boardDisplay = {};
            resultCells.forEach(pos => boardDisplay[pos] = 'black');
            displayBoard(boardDisplay, 'complement4x4Board', setCard.cells);
        }

        // ‡∏£‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                testIntersectionEmpty();
                testComplement2x2();
                testComplement4x4();
            }, 100);
        });
    </script>
</body>
</html>